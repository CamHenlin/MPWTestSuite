#include <QuickDraw.h>#include <Window.h>#include <Locator.h>#include <Memory.h>#include <Menu.h>#include <IntMath.h>#include <Dialog.h>#include <Desk.h>int MyID;Ref gStartStopRef;GrafPortPtr window;WmTaskRec gMainEvent;boolean gDoneFlag = false;#define kStartStopResID 1int tools[] = {11,	4, 0x100,          /* QuickDraw II */	5, 0x100,          /* Desk Manager */	6, 0x100,          /* Event Manager */	14, 0x100,         /* Window Manager */	15, 0x100,         /* Menu Manager */	16, 0x100,         /* Control Mnager */	20, 0x100,         /* Line Edit */	21, 0x100,         /* Dialog Manager */	23, 0x100,         /* Standard File  */	27, 0x100,         /* Font Manager */	28, 0};            /* List Manager */char **y,*z;/* File Menu */char fileMenu[] = ">L  File  \\N2\r\L Quit\\*QqN257\r";static ParamList WindParams = {	sizeof(WindParams),       /* Record size      */	fVis+fAllocated+fTitle+fClose+fMove,/* Frame      */	"\pHello MPW",                     /* Ptr to title     */	0L,                     /* RefCon           */	0,0,0,0,                /* Full size ( 0 --> default)*/	0L,                     /* Color Table Ptr  */	0,                      /* Vertical Origin  */	0,                      /* Horizontal Origin    */	0,                    /* Data area hight  */	0,                    /* Data area width  */	0,                    /* Max cont height  */	0,                    /* max cont width   */	0,                      /* pixels to scroll vert    */	0,                     /* pixels to scroll horz    */	0,                     /* pixels to page vert      */	0,                    /* pixels to page horz      */	0L,                     /* info bar string      */	0,                      /* info bar height      */	0L,                     /* def proc ptr         */	0L,                    /* info bar def proc */	0L,                     /* Content def proc     */	{ 50, 50,150,300} ,            /* size/pos of content  */	(GrafPortPtr) -1L,                    /* plane of window      */	0L};                     /* Wind Rec add         */DoMenu(){	switch (gMainEvent.wmTaskData & 0xffff)	{		case 257:		gDoneFlag = true;		break;	}	HiliteMenu(FALSE, (Word)(gMainEvent.wmTaskData>>16));}ShutDownStuff(){	DeskShutDown();		CtlShutDown();	DialogShutDown();	EMShutDown();	LEShutDown();	MenuShutDown();	WindShutDown();		QDShutDown();		MTShutDown();	IMShutDown();		DisposeHandle( y );		MMShutDown(MyID);	TLShutDown();}main(){	TLStartUp();	MyID = MMStartUp();			MTStartUp();	IMStartUp();			y = NewHandle(0xa00L,                       /* Ten pages            */				  MyID,                         /* put it to my name    */				  0xc005,          /*  locked, fixed, fixed bank, page algn'd */				  0L);                          /* don't care           */		z = *y;                                     /* deref handle     */		QDStartUp((int) z,0x80,160,MyID);			EMStartUp((int) z + 0x300,20,0,640,0,200,MyID);		MoveTo(20,20);	SetBackColor(0);	SetForeColor(0xf);	DrawString("\pOne Moment Please ... ");	ShowCursor();		LoadTools(tools);			WindStartUp(MyID);	RefreshDesktop(0L);	CtlStartUp(MyID,(int) z + 0x400);		DialogStartUp(MyID);	MenuStartUp(MyID, (int) z + 0x600);	DeskStartUp();                             /* All we need is init'ed now */		InitCursor();		SetMenuBar(nil);		InsertMenu(NewMenu(fileMenu),0);		FixAppleMenu(1);	FixMenuBar();	DrawMenuBar();		window = NewWindow(&WindParams);		SetPort(window);	MoveTo(20,20);	DrawString("\pTest IIGS C");			gMainEvent.wmTaskMask = 0x00000fff;	while (!gDoneFlag)	{		int code;				do {		code = TaskMaster(0xFFFF,&gMainEvent);		}		while(!code);		switch (code) {			case 17:				DoMenu();				break;		}	}		ShutDownStuff();		return 0;}